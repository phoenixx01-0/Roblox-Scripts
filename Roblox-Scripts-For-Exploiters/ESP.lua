
getgenv().Toggle = true
getgenv().TC = false

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LP = Players.LocalPlayer

task.wait(1)

pcall(function()
    game.StarterGui:SetCore("SendNotification", {
        Title = "Notification",
        Text = "This Script Was Made By Phoenix",
        Button1 = "Ok",
        Button2 = "Shut Up",
        Duration = 10
    })
end)

task.wait(0.5)

pcall(function()
    game.StarterGui:SetCore("SendNotification", {
        Title = "Notification",
        Text = "Original Script At https://github.com/phoenixx01-0/Roblox-Scripts/blob/main/Roblox-Scripts-For-Exploiters/ESP.lua",
        Button1 = "Ok",
        Button2 = "SybauðŸ¤¬",
        Duration = 10
    })
end)


local partGlows = {}

-- Function to clean up ESP for a specific player
local function removePartESP(player)
    if partGlows[player] then
        for _, obj in pairs(partGlows[player]) do
            obj:Destroy()
        end
        partGlows[player] = nil
    end
end

Players.PlayerRemoving:Connect(removePartESP)

local function createPartESP(player)
    if player == LP or not player.Character then return end
    
    local char = player.Character
    if not partGlows[player] then
        partGlows[player] = {}
    end

    -- Color shifting logic
    local hue = (tick() * 0.2) % 1
    local color = Color3.fromHSV(hue, 0.8, 1)

    -- 1. THE WALL HACK (Highlight)
    -- This makes the actual character model visible through walls
    local hl = char:FindFirstChild("PartHighlight")
    if not hl then
        hl = Instance.new("Highlight")
        hl.Name = "PartHighlight"
        hl.Parent = char
        hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        hl.FillTransparency = 0.5
        hl.OutlineTransparency = 0
        table.insert(partGlows[player], hl)
    end
    hl.FillColor = color
    hl.OutlineColor = color

    -- 2. INDIVIDUAL PART GLOW
    -- Loops through every limb/part of the character
    for _, part in ipairs(char:GetChildren()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            local adornment = part:FindFirstChild("GlowBox")
            if not adornment then
                -- SelectionBox is the cleanest way to make parts "thick" and visible
                adornment = Instance.new("SelectionBox")
                adornment.Name = "GlowBox"
                adornment.Parent = part
                adornment.Adornee = part
                adornment.LineThickness = 0.08 -- ADJUST THICKNESS HERE
                adornment.SurfaceTransparency = 0.8 -- Makes the surface glow slightly
                table.insert(partGlows[player], adornment)
            end
            adornment.Color3 = color
            adornment.SurfaceColor3 = color
        end
    end

    -- 3. OVERHEAD INFO
    local head = char:FindFirstChild("Head")
    if head then
        local gui = head:FindFirstChild("ESP_GUI")
        if not gui then
            gui = Instance.new("BillboardGui", head)
            gui.Name = "ESP_GUI"
            gui.AlwaysOnTop = true
            gui.Size = UDim2.new(0, 200, 0, 50)
            gui.StudsOffset = Vector3.new(0, 3, 0)

            local label = Instance.new("TextLabel", gui)
            label.Size = UDim2.new(1, 0, 1, 0)
            label.BackgroundTransparency = 1
            label.Font = Enum.Font.RobotoMono
            label.TextSize = 16
            label.TextStrokeTransparency = 0
            label.TextColor3 = Color3.new(1, 1, 1)
        end
        
        local dist = math.floor((LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") and (LP.Character.HumanoidRootPart.Position - head.Position).Magnitude) or 0)
        gui.TextLabel.Text = player.Name .. " [" .. dist .. "m]"
        gui.TextLabel.TextColor3 = color
    end
end

-- Update Loop
RunService.RenderStepped:Connect(function()
    if not getgenv().Toggle then
        for player, _ in pairs(partGlows) do removePartESP(player) end
        return 
    end

    for _, player in pairs(Players:GetPlayers()) do
        if getgenv().TC and player.Team == LP.Team then
            removePartESP(player)
            continue
        end
        createPartESP(player)
    end
end)


